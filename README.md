local and gloabl similarity calculation
